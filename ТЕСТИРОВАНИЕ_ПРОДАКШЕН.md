# ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–¥–∞–∫—à–Ω-–≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

**–î–∞—Ç–∞:** 2025-01-27  
**–°—Ç–∞—Ç—É—Å:** üü¢ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```powershell
‚úÖ –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:
   - fastapi>=0.104.0
   - uvicorn[standard]>=0.24.0
   - redis>=5.0.0
   - slowapi>=0.1.9
   - prometheus-fastapi-instrumentator>=6.0.0
```

### 2. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```powershell
‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è
‚úÖ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ –ø–æ—Ä—Ç—É 8000
‚úÖ –í—Å–µ –º–æ–¥—É–ª–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
```

### 3. Health Check Endpoint
```json
{
  "status": "degraded",
  "checks": {
    "redis": "error"
  }
}
```
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback)

### 4. API Endpoints

#### –°–æ–∑–¥–∞–Ω–∏–µ –∏–≥—Ä—ã
```powershell
POST /api/game/start
‚úÖ –ò–≥—Ä–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
‚úÖ Game ID –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è: c45e0c6d-d202-49ec-bd94-f9349a0ec8b7
‚úÖ –î–æ—Å–∫–∞ 5x5 –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
‚úÖ –°—Ç–∞—Ç—É—Å: "playing"
```

#### –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ö–æ–¥–∞
```powershell
POST /api/game/move
‚úÖ –•–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
‚úÖ –°—Ç–∞—Ç—É—Å: "playing"
‚úÖ –•–æ–¥ –∏–≥—Ä–æ–∫–∞ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω: Board[0][0] = 'X'
‚úÖ Fallback —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –≤ –ø–∞–º—è—Ç–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
```

#### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∏–≥—Ä—ã
```powershell
GET /api/game/{game_id}
‚úÖ –°—Ç–∞—Ç—É—Å –∏–≥—Ä—ã –ø–æ–ª—É—á–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```

### 5. Prometheus –º–µ—Ç—Ä–∏–∫–∏
```powershell
GET /metrics
‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã
‚úÖ –°–æ–±–∏—Ä–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –æ:
   - HTTP –∑–∞–ø—Ä–æ—Å–∞—Ö
   - –í—Ä–µ–º–µ–Ω–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
   - Python GC
   - –†–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫–∞—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```

### 6. Rate Limiting
```powershell
‚úÖ Rate limiting –Ω–∞—Å—Ç—Ä–æ–µ–Ω:
   - /api/game/start: 20/–º–∏–Ω—É—Ç—É
   - /api/game/move: 60/–º–∏–Ω—É—Ç—É
   - /api/game/{game_id}: 100/–º–∏–Ω—É—Ç—É
‚úÖ Middleware —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```

### 7. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```powershell
‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
‚úÖ –õ–æ–≥–∏ –≤–∫–ª—é—á–∞—é—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç (game_id, chat_id)
‚úÖ –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ LOG_LEVEL
```

### 8. CORS
```powershell
‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã: http://localhost:3000, http://localhost:5173
```

### 9. Fallback —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
```powershell
‚úÖ –ü—Ä–∏ USE_REDIS=false –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–∞–º—è—Ç—å
‚úÖ –ò–≥—Ä—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
‚úÖ –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –∏–≥—Ä–∞–º–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
```

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|-----------|--------|------------|
| –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ | ‚úÖ | –í—Å–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã |
| –ò–º–ø–æ—Ä—Ç –º–æ–¥—É–ª–µ–π | ‚úÖ | –ë–µ–∑ –æ—à–∏–±–æ–∫ |
| Health Check | ‚úÖ | –†–∞–±–æ—Ç–∞–µ—Ç (Redis fallback) |
| –°–æ–∑–¥–∞–Ω–∏–µ –∏–≥—Ä—ã | ‚úÖ | –£—Å–ø–µ—à–Ω–æ |
| –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ö–æ–¥–∞ | ‚úÖ | –£—Å–ø–µ—à–Ω–æ |
| –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ | ‚úÖ | –£—Å–ø–µ—à–Ω–æ |
| Prometheus –º–µ—Ç—Ä–∏–∫–∏ | ‚úÖ | –î–æ—Å—Ç—É–ø–Ω—ã |
| Rate Limiting | ‚úÖ | –ù–∞—Å—Ç—Ä–æ–µ–Ω |
| –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | ‚úÖ | –†–∞–±–æ—Ç–∞–µ—Ç |
| CORS | ‚úÖ | –ù–∞—Å—Ç—Ä–æ–µ–Ω |
| Fallback —Ö—Ä–∞–Ω–∏–ª–∏—â–µ | ‚úÖ | –†–∞–±–æ—Ç–∞–µ—Ç |

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ Redis —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
```powershell
$env:USE_REDIS="false"
```

–ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `backend/.env`:
```env
USE_REDIS=false
```

---

## ‚úÖ –ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

**–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:**
- ‚úÖ Redis –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (—Å fallback)
- ‚úÖ Rate Limiting
- ‚úÖ Prometheus –º–µ—Ç—Ä–∏–∫–∏
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ Health Check
- ‚úÖ CORS
- ‚úÖ API endpoints

**–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ!**

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:**
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å Redis
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å `USE_REDIS=true`
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ CORS –¥–æ–º–µ–Ω—ã
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (WARNING/ERROR)

2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Grafana –¥–ª—è Prometheus –º–µ—Ç—Ä–∏–∫
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–±–æ—Ä –ª–æ–≥–æ–≤

3. **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å HTTPS
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å reverse proxy (Nginx)
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI/CD

---

**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–î–∞—Ç–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** 2025-01-27


